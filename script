--[[
    BACKDOOR ADMIN SCRIPT
    Features:
    - ESP for spawnable items (Coal, BloxyCola, Cake, Battery)
    - Bring items to you and put them in your inventory
    - Unlimited Stamina, Energy, Hunger toggles
    - Draggable & Minimizable GUI
    
    Execute this script in-game with an executor
]]

local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local RunService = game:GetService("RunService")
local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")

local player = Players.LocalPlayer
local toolsFolder = ReplicatedStorage.GameAssets.Tools
local interactablesFolder = workspace._Game._Interactables

-- ESP Variables
local espEnabled = false
local espObjects = {}
local espConnection = nil

-- Stat Variables
local unlimitedStamina = false
local unlimitedEnergy = false
local unlimitedHunger = false
local statConnection = nil

-- Target items for ESP and bringing
local targetItems = {"Coal", "BloxyCola", "Cake", "Battery"}

-- Create GUI
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Name = "BackdoorAdmin"
ScreenGui.ResetOnSpawn = false
ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
ScreenGui.Parent = player:WaitForChild("PlayerGui")

-- Main Frame
local MainFrame = Instance.new("Frame")
MainFrame.Name = "MainFrame"
MainFrame.Size = UDim2.new(0, 220, 0, 380)
MainFrame.Position = UDim2.new(0.5, -110, 0.5, -190)
MainFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
MainFrame.BorderSizePixel = 0
MainFrame.Active = true
MainFrame.Parent = ScreenGui

local MainCorner = Instance.new("UICorner")
MainCorner.CornerRadius = UDim.new(0, 8)
MainCorner.Parent = MainFrame

-- Title Bar (for dragging)
local TitleBar = Instance.new("Frame")
TitleBar.Name = "TitleBar"
TitleBar.Size = UDim2.new(1, 0, 0, 30)
TitleBar.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
TitleBar.BorderSizePixel = 0
TitleBar.Parent = MainFrame

local TitleCorner = Instance.new("UICorner")
TitleCorner.CornerRadius = UDim.new(0, 8)
TitleCorner.Parent = TitleBar

local TitleFix = Instance.new("Frame")
TitleFix.Size = UDim2.new(1, 0, 0.5, 0)
TitleFix.Position = UDim2.new(0, 0, 0.5, 0)
TitleFix.BackgroundColor3 = Color3.fromRGB(45, 45, 45)
TitleFix.BorderSizePixel = 0
TitleFix.Parent = TitleBar

local TitleLabel = Instance.new("TextLabel")
TitleLabel.Size = UDim2.new(1, -50, 1, 0)
TitleLabel.Position = UDim2.new(0, 10, 0, 0)
TitleLabel.BackgroundTransparency = 1
TitleLabel.Text = "Backdoor Admin"
TitleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
TitleLabel.TextSize = 14
TitleLabel.Font = Enum.Font.GothamBold
TitleLabel.TextXAlignment = Enum.TextXAlignment.Left
TitleLabel.Parent = TitleBar

-- Minimize Button
local MinimizeBtn = Instance.new("TextButton")
MinimizeBtn.Name = "MinimizeBtn"
MinimizeBtn.Size = UDim2.new(0, 25, 0, 25)
MinimizeBtn.Position = UDim2.new(1, -28, 0, 2.5)
MinimizeBtn.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
MinimizeBtn.BorderSizePixel = 0
MinimizeBtn.Text = "-"
MinimizeBtn.TextColor3 = Color3.fromRGB(255, 255, 255)
MinimizeBtn.TextSize = 18
MinimizeBtn.Font = Enum.Font.GothamBold
MinimizeBtn.Parent = TitleBar

local MinCorner = Instance.new("UICorner")
MinCorner.CornerRadius = UDim.new(0, 4)
MinCorner.Parent = MinimizeBtn

-- Content Frame
local ContentFrame = Instance.new("Frame")
ContentFrame.Name = "ContentFrame"
ContentFrame.Size = UDim2.new(1, -20, 1, -40)
ContentFrame.Position = UDim2.new(0, 10, 0, 35)
ContentFrame.BackgroundTransparency = 1
ContentFrame.Parent = MainFrame

local ContentLayout = Instance.new("UIListLayout")
ContentLayout.SortOrder = Enum.SortOrder.LayoutOrder
ContentLayout.Padding = UDim.new(0, 6)
ContentLayout.Parent = ContentFrame

-- Function to create buttons
local function createButton(name, text, color, layoutOrder)
    local btn = Instance.new("TextButton")
    btn.Name = name
    btn.Size = UDim2.new(1, 0, 0, 28)
    btn.BackgroundColor3 = color
    btn.BorderSizePixel = 0
    btn.Text = text
    btn.TextColor3 = Color3.fromRGB(255, 255, 255)
    btn.TextSize = 12
    btn.Font = Enum.Font.GothamSemibold
    btn.LayoutOrder = layoutOrder
    btn.Parent = ContentFrame
    
    local corner = Instance.new("UICorner")
    corner.CornerRadius = UDim.new(0, 6)
    corner.Parent = btn
    
    return btn
end

-- Create Section Label
local function createLabel(text, layoutOrder)
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 0, 18)
    label.BackgroundTransparency = 1
    label.Text = text
    label.TextColor3 = Color3.fromRGB(150, 150, 150)
    label.TextSize = 11
    label.Font = Enum.Font.GothamBold
    label.TextXAlignment = Enum.TextXAlignment.Left
    label.LayoutOrder = layoutOrder
    label.Parent = ContentFrame
    return label
end

-- Create UI Elements
createLabel("Player Stats", 1)
local staminaBtn = createButton("Stamina", "Infinite Stamina: OFF", Color3.fromRGB(80, 80, 80), 2)
local energyBtn = createButton("Energy", "Infinite Energy: OFF", Color3.fromRGB(80, 80, 80), 3)
local hungerBtn = createButton("Hunger", "Infinite Hunger: OFF", Color3.fromRGB(80, 80, 80), 4)

createLabel("ESP Controls", 5)
local espToggleBtn = createButton("ESPToggle", "ESP: OFF", Color3.fromRGB(80, 80, 80), 6)

createLabel("Bring Items to Inventory", 7)
local bringCoalBtn = createButton("BringCoal", "Bring Coal", Color3.fromRGB(50, 50, 50), 8)
local bringBloxyBtn = createButton("BringBloxy", "Bring BloxyCola", Color3.fromRGB(200, 50, 50), 9)
local bringCakeBtn = createButton("BringCake", "Bring Cake", Color3.fromRGB(200, 150, 50), 10)
local bringBatteryBtn = createButton("BringBattery", "Bring Battery", Color3.fromRGB(50, 150, 50), 11)
local bringAllBtn = createButton("BringAll", "Bring ALL Items", Color3.fromRGB(100, 50, 150), 12)

-- Dragging functionality
local dragging = false
local dragStart = nil
local startPos = nil

TitleBar.InputBegan:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = true
        dragStart = input.Position
        startPos = MainFrame.Position
    end
end)

TitleBar.InputEnded:Connect(function(input)
    if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
        dragging = false
    end
end)

UserInputService.InputChanged:Connect(function(input)
    if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
        local delta = input.Position - dragStart
        MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
    end
end)

-- Minimize functionality
local minimized = false
local originalSize = MainFrame.Size
MinimizeBtn.MouseButton1Click:Connect(function()
    minimized = not minimized
    if minimized then
        ContentFrame.Visible = false
        MainFrame.Size = UDim2.new(0, 220, 0, 30)
        MinimizeBtn.Text = "+"
    else
        ContentFrame.Visible = true
        MainFrame.Size = originalSize
        MinimizeBtn.Text = "-"
    end
end)

-- Stat Functions
local function updateStats()
    if unlimitedStamina or unlimitedEnergy or unlimitedHunger then
        if not statConnection then
            statConnection = RunService.Heartbeat:Connect(function()
                if unlimitedStamina then
                    local staminaVal = player:FindFirstChild("StaminaVal")
                    if staminaVal then
                        staminaVal.Value = 150
                    end
                end
                
                if unlimitedEnergy then
                    local energyVal = player:FindFirstChild("EnergyVal")
                    if energyVal then
                        energyVal.Value = 100
                    end
                end
                
                if unlimitedHunger then
                    local hungerVal = player:FindFirstChild("HungerVal")
                    if hungerVal then
                        hungerVal.Value = 100
                    end
                end
            end)
        end
    else
        if statConnection then
            statConnection:Disconnect()
            statConnection = nil
        end
    end
end

local function toggleStamina()
    unlimitedStamina = not unlimitedStamina
    if unlimitedStamina then
        staminaBtn.Text = "Infinite Stamina: ON"
        staminaBtn.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
    else
        staminaBtn.Text = "Infinite Stamina: OFF"
        staminaBtn.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
    end
    updateStats()
end

local function toggleEnergy()
    unlimitedEnergy = not unlimitedEnergy
    if unlimitedEnergy then
        energyBtn.Text = "Infinite Energy: ON"
        energyBtn.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
    else
        energyBtn.Text = "Infinite Energy: OFF"
        energyBtn.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
    end
    updateStats()
end

local function toggleHunger()
    unlimitedHunger = not unlimitedHunger
    if unlimitedHunger then
        hungerBtn.Text = "Infinite Hunger: ON"
        hungerBtn.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
    else
        hungerBtn.Text = "Infinite Hunger: OFF"
        hungerBtn.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
    end
    updateStats()
end

-- ESP Functions
local function createESP(item)
    if espObjects[item] then return end
    
    local highlight = Instance.new("Highlight")
    highlight.Name = "ESP"
    highlight.FillColor = Color3.fromRGB(0, 255, 0)
    highlight.OutlineColor = Color3.fromRGB(255, 255, 255)
    highlight.FillTransparency = 0.5
    highlight.OutlineTransparency = 0
    highlight.Parent = item
    
    local billboard = Instance.new("BillboardGui")
    billboard.Name = "ESPBillboard"
    billboard.Size = UDim2.new(0, 100, 0, 40)
    billboard.StudsOffset = Vector3.new(0, 2, 0)
    billboard.AlwaysOnTop = true
    billboard.Parent = item
    
    local nameLabel = Instance.new("TextLabel")
    nameLabel.Size = UDim2.new(1, 0, 0.5, 0)
    nameLabel.BackgroundTransparency = 1
    nameLabel.TextColor3 = Color3.fromRGB(0, 255, 0)
    nameLabel.TextStrokeTransparency = 0
    nameLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
    nameLabel.Text = item.Name
    nameLabel.TextScaled = true
    nameLabel.Font = Enum.Font.GothamBold
    nameLabel.Parent = billboard
    
    local distLabel = Instance.new("TextLabel")
    distLabel.Name = "Distance"
    distLabel.Size = UDim2.new(1, 0, 0.5, 0)
    distLabel.Position = UDim2.new(0, 0, 0.5, 0)
    distLabel.BackgroundTransparency = 1
    distLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
    distLabel.TextStrokeTransparency = 0
    distLabel.TextStrokeColor3 = Color3.fromRGB(0, 0, 0)
    distLabel.Text = "0m"
    distLabel.TextScaled = true
    distLabel.Font = Enum.Font.Gotham
    distLabel.Parent = billboard
    
    espObjects[item] = {highlight = highlight, billboard = billboard, distLabel = distLabel}
end

local function removeESP(item)
    if espObjects[item] then
        espObjects[item].highlight:Destroy()
        espObjects[item].billboard:Destroy()
        espObjects[item] = nil
    end
end

local function updateESP()
    local character = player.Character
    local hrp = character and character:FindFirstChild("HumanoidRootPart")
    
    -- Add ESP to new items
    for _, item in ipairs(interactablesFolder:GetChildren()) do
        local isTarget = table.find(targetItems, item.Name)
        if isTarget and not espObjects[item] then
            createESP(item)
        end
    end
    
    -- Update distances and remove destroyed items
    for item, data in pairs(espObjects) do
        if not item.Parent then
            removeESP(item)
        elseif hrp and data.distLabel then
            local dist = math.floor((hrp.Position - item.Position).Magnitude)
            data.distLabel.Text = dist .. "m"
        end
    end
end

local function toggleESP()
    espEnabled = not espEnabled
    
    if espEnabled then
        espToggleBtn.Text = "ESP: ON"
        espToggleBtn.BackgroundColor3 = Color3.fromRGB(0, 150, 0)
        
        updateESP()
        espConnection = RunService.Heartbeat:Connect(updateESP)
    else
        espToggleBtn.Text = "ESP: OFF"
        espToggleBtn.BackgroundColor3 = Color3.fromRGB(80, 80, 80)
        
        if espConnection then
            espConnection:Disconnect()
            espConnection = nil
        end
        
        for item, _ in pairs(espObjects) do
            removeESP(item)
        end
    end
end

-- Bring item function - teleports item to player and gives matching tool
local function bringItem(itemName)
    local character = player.Character
    if not character then return end
    
    local hrp = character:FindFirstChild("HumanoidRootPart")
    if not hrp then return end
    
    local backpack = player:FindFirstChild("Backpack")
    if not backpack then return end
    
    local count = 0
    for _, item in ipairs(interactablesFolder:GetChildren()) do
        if item.Name == itemName then
            -- Destroy the world item
            item:Destroy()
            
            -- Give player the tool version
            local tool = toolsFolder:FindFirstChild(itemName)
            if tool then
                local clone = tool:Clone()
                clone.Parent = backpack
                count = count + 1
            end
        end
    end
    
    if count > 0 then
        print("Brought " .. count .. "x " .. itemName .. " to inventory!")
    else
        print("No " .. itemName .. " found in the world!")
    end
end

local function bringAllItems()
    for _, itemName in ipairs(targetItems) do
        bringItem(itemName)
    end
end

-- Button connections
staminaBtn.MouseButton1Click:Connect(toggleStamina)
energyBtn.MouseButton1Click:Connect(toggleEnergy)
hungerBtn.MouseButton1Click:Connect(toggleHunger)
espToggleBtn.MouseButton1Click:Connect(toggleESP)
bringCoalBtn.MouseButton1Click:Connect(function() bringItem("Coal") end)
bringBloxyBtn.MouseButton1Click:Connect(function() bringItem("BloxyCola") end)
bringCakeBtn.MouseButton1Click:Connect(function() bringItem("Cake") end)
bringBatteryBtn.MouseButton1Click:Connect(function() bringItem("Battery") end)
bringAllBtn.MouseButton1Click:Connect(bringAllItems)

-- Button hover effects
local buttonOriginalColors = {}
for _, btn in ipairs(ContentFrame:GetChildren()) do
    if btn:IsA("TextButton") then
        buttonOriginalColors[btn] = btn.BackgroundColor3
        btn.MouseEnter:Connect(function()
            local currentColor = btn.BackgroundColor3
            TweenService:Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = Color3.new(
                math.min(currentColor.R + 0.1, 1),
                math.min(currentColor.G + 0.1, 1),
                math.min(currentColor.B + 0.1, 1)
            )}):Play()
        end)
        btn.MouseLeave:Connect(function()
            local targetColor = buttonOriginalColors[btn]
            -- Check if toggle is on
            if btn.Name == "ESPToggle" and espEnabled then
                targetColor = Color3.fromRGB(0, 150, 0)
            elseif btn.Name == "Stamina" and unlimitedStamina then
                targetColor = Color3.fromRGB(0, 150, 0)
            elseif btn.Name == "Energy" and unlimitedEnergy then
                targetColor = Color3.fromRGB(0, 150, 0)
            elseif btn.Name == "Hunger" and unlimitedHunger then
                targetColor = Color3.fromRGB(0, 150, 0)
            end
            TweenService:Create(btn, TweenInfo.new(0.2), {BackgroundColor3 = targetColor}):Play()
        end)
    end
end

print("========================================")
print("    BACKDOOR ADMIN LOADED!")
print("========================================")
print("GUI is now visible on screen")
print("- Drag the title bar to move")
print("- Click - to minimize")
print("========================================")
